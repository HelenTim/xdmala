# 03-Axios 及 Mock.js

## ★首页

1）完成首页推荐商品

1、Vue 和 React 的 template 旗下，只有一个元素包裹其它元素，不然会报错！

2、猜你喜欢？ 

推荐算法 -> 基于大数据

3、一个你不知道的细节？

![js 加样式 to 控制台](assets/img/2020-02-25-19-50-47.png)

4、一个 bug？

``` css
.home {
  padding: 16px;
}
```

在我手机上的效果：

![bug](assets/img/2020-02-26-11-55-28.png)

改成 `padding: 16px 20px 16px 20px;`就咩有图片溢出了。我也不知道为啥会这样，或许是 padding 挤压了 content 的大小

2）弹性盒模型

两栏布局

## ★Ajax & Axios

* Ajax：Asynchronous JavaScript and XML
* Ajax 原理

* Axios 是一个基于 Promise 的 HTTP 库
* 安装 axios： `npm install axios --save` or `yarn add axios` 

1）什么时候发送 ajax 请求？

created 阶段

2）什么叫钩子函数？

`new Vue()`这个操作会经历一个生命周期，每个阶段都会自动调用一个钩子函数，而我们可以往钩子函数添加要处理的代码！

如果不涉及操作真实 DOM -> created -> 反之写在 mounted

3）什么是 Ajax？

不刷新界面的请求，如表单校验之用户名，用户名似乎被校验，肯定需要发送请求的，因为需要去查询数据库，而我们在各大网站注册时，输入用户名，然后移动下一个输入框，被告知「用户名已被占用了」，可见这其中发送了一个 ajax 请求，而这是无刷新的！可见提高了用户体验，不然等所有数据填充好后，再发送就不太好了。

4）Ajax 原理？

1. 创建XMLHttpRequest对象
2. 发送请求
3. 等待服务器端响应 -> 监听 -> 判断各种状态码
4. 对返回的数据进行相应的处理


细节理解：

1. 兼容 IE 处理 -> `new ActiveXObject("Microsoft.XMLHTTP")` -> `new XMLHttpRequest()`较新
2. `xmlhttp.open("GET", movieUrl, true)` -> 第三个参数一般为 true，表示异步请求 -> 不等结果
3. 得到的数据是字符串 -> 需要我们把字符串转化为 JSON
4. 跨域？ -> 使用服务器代理可解决 -> 如这样 `https://bird.ioliu.cn/v2?url=https://api.douban.com/v2/movie/top250`，我们用了 `bird.ioliu.cn`这个 url 指向的服务器作为代理 -> 如果你直接这样 `https://api.douban.com/v2/movie/top250`，就会报跨域的错误！
5. 把数据显示到界面

数据接口地址：

**➹：**[xCss/JsonBird: 🐣A remote data interface proxy service - 一个远程数据接口代理服务](https://github.com/xCss/JsonBird)

5）什么是跨域？

A 域发请求给 B 域接收 -> 但正常情况下，这是不被允许的

如 `localhost:8081`这个域 -> 发请求给`api.douban.com`这个域 -> 这是不被允许的

只要，违反以下三点，即为非同源：

- 协议相同
- 域名相同
- 端口相同

而这意味着，你不能做以下三件事：

（1） Cookie、LocalStorage 和 IndexDB 无法读取。

（2） DOM 无法获得。

（3） AJAX 请求不能发送。

豆瓣电影这个接口，目前不能用哈！小程序也无法用，除非你用了代理服务器！

**➹：**[浏览器同源政策及其规避方法 - 阮一峰的网络日志](https://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html)

6）每次都要写一个Ajax方法吗？有没有封装好的库来帮我们做ajax请求？

Axios就是做这样的事的！







## ★Mock.js

* <http://mockjs.com/>
* 生成随机数据，拦截 Ajax 请求
* 安装 mockjs： `npm install mockjs -D` or `yarn add -D mockjs` 
* Demo

## ★后台接口配置

* 统一定义后台接口
* `src/service.config.js` 
